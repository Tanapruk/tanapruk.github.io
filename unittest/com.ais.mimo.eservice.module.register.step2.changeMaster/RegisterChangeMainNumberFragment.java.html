<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>RegisterChangeMainNumberFragment.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">app</a> &gt; <a href="index.source.html" class="el_package">com.ais.mimo.eservice.module.register.step2.changeMaster</a> &gt; <span class="el_source">RegisterChangeMainNumberFragment.java</span></div><h1>RegisterChangeMainNumberFragment.java</h1><pre class="source lang-java linenums">package com.ais.mimo.eservice.module.register.step2.changeMaster;

import android.os.Bundle;
import android.os.Parcelable;
import android.support.v4.widget.NestedScrollView;
import android.support.v7.widget.RecyclerView;
import android.text.InputType;
import android.view.View;
import android.widget.LinearLayout;

import com.ais.mimo.eservice.module.register.base.RegisterBaseFragment;
import com.ais.mimo.eservice.module.register.step2.changeMaster.adapter.RegisterSelectNumberAdapter;
import com.ais.mimo.eservice.module.register.widget.MyAisRegisterEditText;
import com.ais.mimo.eservice.module.register.widget.manager.MyAisRegisterLinearManager;
import com.ais.mimo.eservice.utility.AnimationViewUtils;
import com.nextzy.myais.common.mvp.NextzyMvpActivity;
import com.nextzy.myais.common.widget.AISButton;
import com.nextzy.myais.common.widget.AISTextView;
import com.nextzy.myais.myais.R;

import java.util.ArrayList;

import static com.ais.mimo.eservice.module.register.step2.RegisterStep2Fragment.KEY_FBB_GROUP;
import static com.ais.mimo.eservice.module.register.step2.RegisterStep2Fragment.KEY_POSTPAID_GROUP;


public class RegisterChangeMainNumberFragment extends RegisterBaseFragment&lt;RegisterChangeMainNumberContractor.Presenter&gt; implements RegisterChangeMainNumberContractor.View {
<span class="nc" id="L28">    public final static String TAG = RegisterChangeMainNumberFragment.class.getSimpleName();</span>
    private MyAisRegisterEditText vSmsOtp;
    private LinearLayout llOtp;
    private RecyclerView rvMobileNumber;
    private RegisterSelectNumberAdapter selectAdapter;
    private LinearLayout baseLayout;
    private NestedScrollView scrollView;
    private AISTextView tvSelectMaster;
    private AISButton btnBack;
    private AISButton btnNext;

    public RegisterChangeMainNumberFragment() {
<span class="nc" id="L40">        super();</span>
<span class="nc" id="L41">    }</span>

    public static RegisterChangeMainNumberFragment newInstance(Bundle data) {
<span class="nc" id="L44">        RegisterChangeMainNumberFragment fragment = new RegisterChangeMainNumberFragment();</span>
<span class="nc" id="L45">        fragment.setArguments(data);</span>
<span class="nc" id="L46">        return fragment;</span>
    }

    /*************************/
    /** Fragment life cycle **/
    /*************************/
    //&lt;editor-fold desc=&quot;Life cycle folding&quot;&gt;

    /**
     * onCreate()
     **/
    @Override
    protected void createPresenter() {
<span class="nc" id="L59">        RegisterChangeMainNumberPresenter.createPresenter(this);</span>
<span class="nc" id="L60">    }</span>

    @Override
    public void restoreArgument(Bundle bundle) {

<span class="nc" id="L65">    }</span>

    /**
     * onViewCreated()
     **/
    @Override
    public void bindView(View view) {
<span class="nc" id="L72">        baseLayout = (LinearLayout) view.findViewById(R.id.my_ais_register_base_layout);</span>
<span class="nc" id="L73">        llOtp = (LinearLayout) view.findViewById(R.id.my_ais_regis_ll_sms_otp);</span>
<span class="nc" id="L74">        tvSelectMaster = (AISTextView) view.findViewById(R.id.my_ais_register_tv_select_master);</span>
<span class="nc" id="L75">        rvMobileNumber = (RecyclerView) view.findViewById(R.id.my_ais_regis_rv_group_mobile_number);</span>
<span class="nc" id="L76">        vSmsOtp = (MyAisRegisterEditText) view.findViewById(R.id.my_ais_register_edt_sms_otp);</span>
<span class="nc" id="L77">        scrollView = (NestedScrollView) view.findViewById(R.id.register_nested_scroll_view);</span>

<span class="nc" id="L79">        btnBack = (AISButton) view.findViewById(R.id.my_ais_register_btn_back);</span>
<span class="nc" id="L80">        btnNext = (AISButton) view.findViewById(R.id.my_ais_register_btn_next);</span>

<span class="nc" id="L82">    }</span>

    @Override
    public void setupView() {
<span class="nc" id="L86">        llOtp.setVisibility(View.GONE);</span>
<span class="nc" id="L87">        showRequestOptBtn();</span>
<span class="nc" id="L88">        setIndexIndicator(1);</span>
<span class="nc" id="L89">        setBackgroundWhite();</span>
<span class="nc" id="L90">        setupClickHideKeyboard(baseLayout);</span>
<span class="nc" id="L91">        vSmsOtp.setInputType(InputType.TYPE_CLASS_NUMBER | InputType.TYPE_NUMBER_VARIATION_PASSWORD);</span>
<span class="nc bnc" id="L92" title="All 2 branches missed.">        if(isFibreGroupFromStep2()){</span>
<span class="nc" id="L93">            vSmsOtp.setHeaderText(getString(R.string.my_ais_register_receive_email_otp));</span>
        }else {
<span class="nc" id="L95">            vSmsOtp.setHeaderText(getString(R.string.my_ais_register_receive_sms_otp));</span>
        }
<span class="nc" id="L97">        setupAdapter();</span>
<span class="nc" id="L98">    }</span>

    @Override
    public void initialize() {
<span class="nc" id="L102">    }</span>

    @Override
    public void restoreView() {
<span class="nc" id="L106">    }</span>

    /**
     * onCreateView
     **/
    @Override
    public int getLayoutView() {
<span class="nc" id="L113">        return R.layout.my_ais_register_fragment_select_master_number;</span>
    }

    /**
     * State
     **/
    @Override
    public void saveInstanceState(Bundle outState) {
        // Save Instance State here
<span class="nc" id="L122">    }</span>

    @Override
    public void restoreInstanceState(Bundle savedInstanceState) {
        // Restore instance state here
<span class="nc" id="L127">    }</span>
    //&lt;/editor-fold&gt;

    @Override
    public void showOtp() {
<span class="nc" id="L132">        AnimationViewUtils.getInstance().expand(llOtp);</span>

<span class="nc" id="L134">        btnBack.setText(getContext().getString(R.string.my_ais_register_back));</span>
<span class="nc" id="L135">        btnBack.setOnClickListener(v -&gt; clickCancel());</span>

<span class="nc" id="L137">        btnNext.setText(getContext().getString(R.string.my_ais_register_next));</span>
<span class="nc" id="L138">        btnNext.setOnClickListener(v -&gt;</span>
<span class="nc" id="L139">                getPresenter().validateVerifyOtp(</span>
<span class="nc" id="L140">                        vSmsOtp.getOtp()));</span>

<span class="nc" id="L142">        scrollToEnd(scrollView, 200);</span>
<span class="nc" id="L143">    }</span>


    @Override
    public void changeArgumentMasterNumber(String mobileNumber) {
<span class="nc" id="L148">        getArguments().putString(KEY_MOBILE_NUMBER, mobileNumber);</span>
<span class="nc" id="L149">    }</span>


    @Override
    public void showDefaultOtpEdt() {
<span class="nc" id="L154">        vSmsOtp.showDefault();</span>
<span class="nc" id="L155">    }</span>

    @Override
    public void showErrorOtpEdt() {
<span class="nc" id="L159">        vSmsOtp.showError();</span>
        String error;
<span class="nc bnc" id="L161" title="All 2 branches missed.">        if (vSmsOtp.getStringFromEditText().isEmpty()) {</span>
<span class="nc" id="L162">            error = getString(R.string.my_ais_register_dialog_otp_none);</span>
        } else {
<span class="nc" id="L164">            error = getString(R.string.my_ais_register_dialog_otp_fault);</span>
        }
<span class="nc" id="L166">        ((NextzyMvpActivity) getActivity())</span>
<span class="nc" id="L167">                .showAlertDialogDismissOnClick(error);</span>
<span class="nc" id="L168">    }</span>

    @Override
    public void showUserNotSelectPostpaidMobileNumber() {
<span class="nc" id="L172">        String error = getString(R.string.my_ais_register_dialog_select_master_cannot_request_otp_list_is_postpaid);</span>
<span class="nc" id="L173">        ((NextzyMvpActivity) getActivity())</span>
<span class="nc" id="L174">                .showAlertDialogDismissOnClick(error);</span>
<span class="nc" id="L175">    }</span>

    @Override
    public void showUserNotSelectFbbMobileNumber() {
<span class="nc" id="L179">        String error = getString(R.string.my_ais_register_dialog_select_master_cannot_request_otp_list_is_fbb);</span>
<span class="nc" id="L180">        ((NextzyMvpActivity) getActivity())</span>
<span class="nc" id="L181">                .showAlertDialogDismissOnClick(error);</span>
<span class="nc" id="L182">    }</span>

    @Override
    public boolean havePostpaidList() {
<span class="nc" id="L186">        ArrayList&lt;Parcelable&gt; postpaidList = getArguments().getParcelableArrayList(KEY_POSTPAID_GROUP);</span>
<span class="nc bnc" id="L187" title="All 4 branches missed.">        return postpaidList != null &amp;&amp; postpaidList.size() != 0;</span>
    }

    @Override
    public boolean haveFbbList() {
<span class="nc" id="L192">        ArrayList&lt;Parcelable&gt; fbbList = getArguments().getParcelableArrayList(KEY_FBB_GROUP);</span>
<span class="nc bnc" id="L193" title="All 4 branches missed.">        return fbbList != null &amp;&amp; fbbList.size() != 0;</span>
    }

    @Override
    public boolean isPostpaidGroupFromStep2(){
<span class="nc" id="L198">        ArrayList&lt;Parcelable&gt; postpaidGroup = getArguments().getParcelableArrayList(KEY_POSTPAID_GROUP);</span>
<span class="nc bnc" id="L199" title="All 4 branches missed.">        return postpaidGroup != null &amp;&amp; postpaidGroup.size() != 0;</span>
    }

    @Override
    public boolean isFibreGroupFromStep2(){
<span class="nc" id="L204">        ArrayList&lt;Parcelable&gt; fibreGroup = getArguments().getParcelableArrayList(KEY_FBB_GROUP);</span>
<span class="nc bnc" id="L205" title="All 4 branches missed.">        return fibreGroup != null &amp;&amp; fibreGroup.size() != 0;</span>
    }

    /********************/
    /** Private method **/
    /********************/
    //&lt;editor-fold desc=&quot;Private function folding&quot;&gt;
    private void setupAdapter() {
<span class="nc" id="L213">        rvMobileNumber.setLayoutManager(new MyAisRegisterLinearManager(getContext()));</span>

<span class="nc bnc" id="L215" title="All 2 branches missed.">        if (isPostpaidGroupFromStep2()) {</span>
<span class="nc" id="L216">            tvSelectMaster.setText(getString(R.string.my_ais_register_dialog_select_master_cannot_request_otp_list_is_postpaid));</span>
<span class="nc" id="L217">            selectAdapter = new RegisterSelectNumberAdapter(</span>
<span class="nc" id="L218">                    getArguments().getParcelableArrayList(KEY_POSTPAID_GROUP));</span>
<span class="nc bnc" id="L219" title="All 2 branches missed.">        } else if (isFibreGroupFromStep2()) {</span>
<span class="nc" id="L220">            tvSelectMaster.setText(getString(R.string.my_ais_register_dialog_select_master_cannot_request_otp_list_is_fbb));</span>
<span class="nc" id="L221">            selectAdapter = new RegisterSelectNumberAdapter(</span>
<span class="nc" id="L222">                    getArguments().getParcelableArrayList(KEY_FBB_GROUP));</span>
        } else {
<span class="nc" id="L224">            getPresenter().goToStep3Fragment();</span>
        }
<span class="nc" id="L226">        selectAdapter.setOnSelectListener((v, mobileNumber, pos) -&gt; clickRadioButton(mobileNumber));</span>
<span class="nc" id="L227">        rvMobileNumber.setAdapter(selectAdapter);</span>
<span class="nc" id="L228">    }</span>


    private void clickRadioButton(String mobileNumber) {
<span class="nc" id="L232">        showRequestOptBtn();</span>
<span class="nc" id="L233">        hindKeyboard();</span>
<span class="nc" id="L234">        getPresenter().setCurrentMobileNumber(mobileNumber);</span>
<span class="nc" id="L235">    }</span>

    private void showRequestOptBtn() {
        // Comment this line because view measurement problem
<span class="nc" id="L239">        btnBack.setVisibility(View.VISIBLE);</span>
<span class="nc" id="L240">        btnNext.setVisibility(View.VISIBLE);</span>

<span class="nc" id="L242">        btnBack.setText(getContext().getString(R.string.my_ais_register_back));</span>
<span class="nc" id="L243">        btnBack.setOnClickListener(v -&gt; clickCancel());</span>

<span class="nc" id="L245">        btnNext.setText(getContext().getString(R.string.my_ais_register_request_otp));</span>
<span class="nc" id="L246">        btnNext.setOnClickListener(v -&gt;</span>
<span class="nc" id="L247">                getPresenter().validateVerifyIdentitySelectedNumber());</span>

<span class="nc" id="L249">        AnimationViewUtils.getInstance().collapse(llOtp);</span>
<span class="nc" id="L250">        scrollToEnd(scrollView, 200);</span>
<span class="nc" id="L251">    }</span>
    //&lt;/editor-fold&gt;
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.7.9.201702052155</span></div></body></html>